import{k as Se,r as l,q as $e,m as me,j as e,C as J,d as he,X as C,f as xe,U as ge,c as Oe,n as z,o as be,t as fe,s as ye}from"./index-DrbYOPtV.js";import{D as ze,Q as pe}from"./DashboardLayout-DD1STFC1.js";import{S as q,Q as je}from"./QRScanner-CnHTzi7D.js";import{C as Ne}from"./calendar-BG1-np7W.js";import{C as we}from"./clock-CYK23m10.js";import"./heart-C3OgWR3f.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=Se("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=Se("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),b=o=>({...o,current_status:o.building_entry?"inside":"outside",building_entry:o.building_entry}),We=()=>{const[o,W]=l.useState("building"),[H,x]=l.useState(null),[m,_]=l.useState(""),[B,A]=l.useState(!1),[D,N]=l.useState([]),[Y,f]=l.useState(!1),[P,ve]=l.useState(null),[ee,ke]=l.useState([]),[r,G]=l.useState(null),[Ce,se]=l.useState(!0),[v,R]=l.useState(null),[K,g]=l.useState(null),[h,T]=l.useState(""),[I,Q]=l.useState(!1),[U,w]=l.useState([]),[te,y]=l.useState(!1),[E,_e]=l.useState(null),[c,d]=l.useState(null),[Be,u]=l.useState(!1),[S,M]=l.useState(!1),[V,p]=l.useState(!1),[X,j]=l.useState(!1),[re,ae]=l.useState(!1),[F,Z]=l.useState(null);l.useEffect(()=>{o==="session"&&ne()},[o]),l.useEffect(()=>{if(P&&clearTimeout(P),o==="building"&&m.trim().length>=2){const s=setTimeout(()=>{Pe(m.trim())},300);ve(s)}else N([]),f(!1);return()=>{P&&clearTimeout(P)}},[m,o]),l.useEffect(()=>{if(E&&clearTimeout(E),o==="session"&&h.trim().length>=2){const s=setTimeout(()=>{Re(h.trim())},300);_e(s)}else w([]),y(!1);return()=>{E&&clearTimeout(E)}},[h,o]);const Ae=async(s,t)=>{if(!s||!t)return!1;try{const{data:n,error:a}=await ye.from("attendances").select("*").eq("user_id",s).eq("session_id",t).eq("scan_type","booking").single();return a&&a.code!=="PGRST116"?(console.error("Error checking session booking:",a),!1):!!n}catch(n){return console.error("Error checking session booking:",n),!1}},De=async(s,t)=>{if(!s||!t)return!1;try{const{data:n,error:a}=await ye.from("attendances").select("*").eq("user_id",s).eq("session_id",t).eq("scan_type","session_entry").single();return a&&a.code!=="PGRST116"?(console.error("Error checking session attendance:",a),!1):!!n}catch(n){return console.error("Error checking session attendance:",n),!1}},L=async(s,t)=>{if(!s||!t){p(!1),j(!1);return}ae(!0);try{const[n,a]=await Promise.all([Ae(s,t),De(s,t)]);p(n),j(a)}catch(n){console.error("Error checking session status:",n),p(!1),j(!1)}finally{ae(!1)}},ne=async()=>{try{se(!0);const{data:s,error:t}=await $e();t?(console.error("Error fetching sessions:",t),i("error","Failed to load sessions")):ke(s||[])}catch(s){console.error("Error fetching sessions:",s),i("error","An unexpected error occurred")}finally{se(!1)}},Pe=async s=>{try{A(!0);const{data:t,error:n}=await me(s);if(n)console.error("Building search error:",n),N([]);else{const a=(t||[]).map(k=>b(k));N(a),f(!0)}}catch(t){console.error("Building search exception:",t),N([])}finally{A(!1)}},Re=async s=>{try{Q(!0);const{data:t,error:n}=await me(s);if(n)console.error("Session search error:",n),w([]);else{const a=(t||[]).map(k=>b(k));w(a),y(!0)}}catch(t){console.error("Session search exception:",t),w([])}finally{Q(!1)}},i=(s,t)=>{Z({type:s,message:t}),setTimeout(()=>Z(null),5e3)},$=s=>/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s),le=async()=>{if(!m.trim()){i("error","Please enter a Personal ID");return}try{A(!0);const{data:s,error:t}=await z(m.trim());t||!s?i("error","Personal ID not found"):s.role!=="attendee"?i("error","Only attendees can be processed through this system"):(d(b(s)),u(!0),_(""),f(!1),x(null))}catch(s){console.error("Building search exception:",s),i("error","Search failed. Please try again.")}finally{A(!1)}},ie=async()=>{if(!h.trim()){i("error","Please enter a Personal ID");return}try{Q(!0);const{data:s,error:t}=await z(h.trim());if(t||!s)i("error","Personal ID not found");else if(s.role!=="attendee")i("error","Only attendees can be processed through this system");else{const n=b(s);d(n),r&&await L(n.id,r.id),u(!0),T(""),y(!1),g(null)}}catch(s){console.error("Session search exception:",s),i("error","Search failed. Please try again.")}finally{Q(!1)}},Te=s=>{d(s),u(!0),_(""),f(!1),N([]),x(null)},Ie=async s=>{d(s),r&&await L(s.id,r.id),u(!0),T(""),y(!1),w([]),g(null)},Qe=async s=>{try{console.log("Processing Building QR data:",s);let t=null,n;if($(s)){console.log("Detected UUID format, searching by UUID...");const a=await be(s);t=a.data?b(a.data):null,n=a.error}else{console.log("Detected Personal ID format, searching by Personal ID...");const a=await z(s);t=a.data?b(a.data):null,n=a.error}if(n||!t){const a=$(s)?"Invalid QR code: UUID not found in system":"Invalid QR code: Personal ID not found";i("error",a);return}if(t.role!=="attendee"){i("error","Only attendees can be processed through this system");return}d(t),u(!0),x(null)}catch(t){console.error("Building QR scan error:",t),i("error","Failed to process QR code")}},Ue=async s=>{try{console.log("Processing Session QR data:",s);let t=null,n;if($(s)){console.log("Detected UUID format, searching by UUID...");const a=await be(s);t=a.data?b(a.data):null,n=a.error}else{console.log("Detected Personal ID format, searching by Personal ID...");const a=await z(s);t=a.data?b(a.data):null,n=a.error}if(n||!t){const a=$(s)?"Invalid QR code: UUID not found in system":"Invalid QR code: Personal ID not found";i("error",a);return}if(t.role!=="attendee"){i("error","Only attendees can be processed through this system");return}r&&await L(t.id,r.id),d(t),u(!0),g(null)}catch(t){console.error("Session QR scan error:",t),i("error","Failed to process QR code")}},oe=async s=>{if(c)try{M(!0);const t=s==="enter"?"building_entry":"building_exit",{data:n,error:a}=await fe(c.personal_id,t);if(a){i("error",a.message||`Failed to process ${s}`);return}i("success",n.message||`Building ${s.toUpperCase()} successful!`);const k=s==="enter"?"inside":"outside";d(ue=>ue?{...ue,current_status:k,last_scan:new Date().toISOString()}:null),setTimeout(()=>{u(!1),d(null)},2e3)}catch(t){console.error("Building attendance action error:",t),i("error",`Failed to process ${s}`)}finally{M(!1)}},Ee=async()=>{if(!(!c||!r))try{M(!0);const{data:s,error:t}=await fe(c.personal_id,"session_entry",r.id);if(t){i("error",t.message||"Failed to add to session");return}i("success",s.message||"Successfully added to session!"),ne(),setTimeout(()=>{u(!1),d(null),R(null),p(!1),j(!1)},2e3)}catch(s){console.error("Session attendance action error:",s),i("error","Failed to add to session")}finally{M(!1)}},ce=()=>{_(""),N([]),f(!1)},de=()=>{T(""),w([]),y(!1)},Me=()=>{x(null),d(null),u(!1),ce()},Fe=()=>{R(null),g(null),G(null),d(null),u(!1),p(!1),j(!1),de()},O=s=>{try{return new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return s}},Le=s=>{try{return new Date(s).toLocaleDateString()}catch{return s}};return l.useEffect(()=>{r&&c&&L(c.id,r.id)},[r,c]),e.jsxs(ze,{title:"Build Team Dashboard",subtitle:"Manage building and session attendance",children:[F&&e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center space-x-2 px-4 py-3 rounded-lg shadow-lg ${F.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:[F.type==="success"?e.jsx(J,{className:"h-5 w-5"}):e.jsx(he,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:F.message}),e.jsx("button",{onClick:()=>Z(null),className:"ml-2 hover:bg-black hover:bg-opacity-20 rounded p-1",children:e.jsx(C,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex space-x-6 mb-8 border-b border-gray-200",children:[e.jsx("button",{onClick:()=>{W("building"),Fe()},className:`pb-2 px-2 text-sm font-medium ${o==="building"?"text-orange-600 border-b-2 border-orange-600":"text-gray-500 hover:text-gray-700"}`,children:"Building"}),e.jsx("button",{onClick:()=>{W("session"),Me()},className:`pb-2 px-2 text-sm font-medium ${o==="session"?"text-orange-600 border-b-2 border-orange-600":"text-gray-500 hover:text-gray-700"}`,children:"Sessions"})]}),e.jsxs("div",{className:"space-y-8",children:[o==="building"&&e.jsxs(e.Fragment,{children:[!H&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-orange-100 p-8 space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 text-center flex items-center justify-center gap-2",children:[e.jsx(qe,{className:"h-6 w-6 text-orange-500"}),"Building Attendance Management"]}),e.jsx("p",{className:"text-gray-600 text-center",children:"Manage entry and exit for attendees using QR code scanning or manual search"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("button",{onClick:()=>x("qr"),className:"flex items-center justify-center p-4 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:[e.jsx(pe,{className:"h-5 w-5 mr-2"}),"QR Code Scanner"]}),e.jsxs("button",{onClick:()=>x("manual"),className:"flex items-center justify-center p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Search by Personal ID"]})]})]}),H==="manual"&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Attendees by Personal ID"}),e.jsxs("div",{className:"flex items-center space-x-3 relative",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",placeholder:"Start typing Personal ID (e.g., 123456...)",value:m,onChange:s=>_(s.target.value),onKeyDown:s=>s.key==="Enter"&&le(),onBlur:()=>{setTimeout(()=>f(!1),200)},onFocus:()=>D.length>0&&f(!0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-colors"}),m&&e.jsx("button",{onClick:ce,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(C,{className:"h-5 w-5"})}),Y&&D.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:D.map(s=>e.jsx("button",{onClick:()=>Te(s),className:"w-full px-4 py-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 focus:bg-orange-50 focus:outline-none",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",s.personal_id]}),s.university&&e.jsx("p",{className:"text-xs text-gray-500",children:s.university})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.current_status==="inside"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.current_status==="inside"?"Inside":"Outside"})})]})},s.id))}),Y&&D.length===0&&m.trim().length>=2&&!B&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 px-4 py-3",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:['No attendees found matching "',m,'"']})}),B&&m.trim().length>=2&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-500"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Searching attendees..."})]})})]}),e.jsx("button",{onClick:le,disabled:B||!m.trim(),className:"px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:B?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-5 w-5"}),e.jsx("span",{children:"Search"})]})})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"font-medium mb-1",children:"Search Tips:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[e.jsx("li",{children:"Start typing to see dynamic suggestions (minimum 2 characters)"}),e.jsx("li",{children:"Only attendees will appear in search results"}),e.jsx("li",{children:"Click on a suggestion to select that attendee"}),e.jsx("li",{children:"Use QR Scanner for faster lookup"})]})]}),e.jsx("button",{onClick:()=>x(null),className:"text-sm text-gray-500 underline",children:"â† Back to options"})]})})]}),o==="session"&&e.jsxs(e.Fragment,{children:[!r&&e.jsx(e.Fragment,{children:Ce?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading sessions..."})]}):ee.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(Ne,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Sessions Available"}),e.jsx("p",{className:"text-gray-600",children:"There are currently no sessions scheduled."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ee.map(s=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-orange-100 p-6 cursor-pointer hover:shadow-md transition",onClick:()=>G(s),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-1",children:s.title}),e.jsx(Ne,{className:"h-5 w-5 text-orange-500 flex-shrink-0"})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2",children:[s.start_time&&e.jsxs("p",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(we,{className:"inline-block h-4 w-4 mr-1"}),O(s.start_time)," - ",O(s.end_time)]}),s.speaker&&e.jsxs("p",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(xe,{className:"inline-block h-4 w-4 mr-1"}),s.speaker]}),s.location&&e.jsxs("p",{className:"text-sm text-gray-500",children:["ðŸ“ ",s.location]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:[e.jsx(ge,{className:"inline-block h-4 w-4 mr-1"}),s.current_attendees,typeof s.capacity=="number"&&s.capacity>0&&`/${s.capacity}`," attendees"]}),typeof s.capacity=="number"&&s.capacity>0&&s.current_attendees>=s.capacity&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"Full"})]})]})]},s.id))})}),r&&!v&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-orange-100 p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:r.title}),e.jsx("button",{onClick:()=>G(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(C,{className:"h-5 w-5"})})]}),r.description&&e.jsx("p",{className:"text-gray-600",children:r.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.start_time&&e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{className:"text-sm",children:[Le(r.start_time)," â€¢ ",O(r.start_time)," - ",O(r.end_time)]})]}),r.speaker&&e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{className:"text-sm",children:["Speaker: ",r.speaker]})]}),r.location&&e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“"}),e.jsx("span",{className:"text-sm",children:r.location})]}),e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{className:"text-sm",children:[r.current_attendees,r.capacity&&`/${r.capacity}`," attendees"]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:()=>R("session_entry"),disabled:typeof r.capacity=="number"&&r.capacity>0&&r.current_attendees>=r.capacity,className:"w-full flex items-center justify-center p-4 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:[e.jsx(He,{className:"h-5 w-5 mr-2"}),"Add Attendee to Session",typeof r.capacity=="number"&&r.capacity>0&&r.current_attendees>=r.capacity&&e.jsx("span",{className:"ml-2 text-xs",children:"(Session Full)"})]})})]}),v==="session_entry"&&!K&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-orange-100 p-6 space-y-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Add Attendee to: ",r==null?void 0:r.title]}),e.jsx("p",{className:"text-gray-600",children:"Choose how you want to identify the attendee"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>g("qr"),className:"flex items-center justify-center p-4 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:[e.jsx(pe,{className:"h-5 w-5 mr-2"}),"QR Code Scanner"]}),e.jsxs("button",{onClick:()=>g("manual"),className:"flex items-center justify-center p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Search by Personal ID"]})]}),e.jsx("button",{onClick:()=>R(null),className:"text-sm text-gray-500 underline",children:"â† Back to session details"})]}),K==="manual"&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Attendees by Personal ID"}),e.jsxs("div",{className:"flex items-center space-x-3 relative",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",placeholder:"Start typing Personal ID (e.g., 123456...)",value:h,onChange:s=>T(s.target.value),onKeyDown:s=>s.key==="Enter"&&ie(),onBlur:()=>{setTimeout(()=>y(!1),200)},onFocus:()=>U.length>0&&y(!0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-colors"}),h&&e.jsx("button",{onClick:de,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(C,{className:"h-5 w-5"})}),te&&U.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:U.map(s=>e.jsx("button",{onClick:()=>Ie(s),className:"w-full px-4 py-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 focus:bg-orange-50 focus:outline-none",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",s.personal_id]}),s.university&&e.jsx("p",{className:"text-xs text-gray-500",children:s.university})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.current_status==="inside"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.current_status==="inside"?"Inside":"Outside"})})]})},s.id))}),te&&U.length===0&&h.trim().length>=2&&!I&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 px-4 py-3",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:['No attendees found matching "',h,'"']})}),I&&h.trim().length>=2&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-500"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Searching attendees..."})]})})]}),e.jsx("button",{onClick:ie,disabled:I||!h.trim(),className:"px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:I?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-5 w-5"}),e.jsx("span",{children:"Search"})]})})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"font-medium mb-1",children:"Search Tips:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[e.jsx("li",{children:"Start typing to see dynamic suggestions (minimum 2 characters)"}),e.jsx("li",{children:"Only attendees will appear in search results"}),e.jsx("li",{children:"Click on a suggestion to select that attendee"}),e.jsx("li",{children:"Use QR Scanner for faster lookup"})]})]}),e.jsx("button",{onClick:()=>g(null),className:"text-sm text-gray-500 underline",children:"â† Back to options"})]})})]}),o==="building"&&H==="qr"&&e.jsx(je,{isOpen:!0,onClose:()=>x(null),onScan:Qe,title:"Building Entry Scanner",description:"Point your camera at the attendee's QR code"}),o==="session"&&K==="qr"&&e.jsx(je,{isOpen:!0,onClose:()=>g(null),onScan:Ue,title:"Session Entry Scanner",description:"Point your camera at the attendee's QR code"}),Be&&c&&Oe.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[200] p-4 modal-backdrop-blur",onClick:()=>{u(!1),d(null),p(!1),j(!1)},children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto modal-content-blur fade-in-up-blur",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"p-6 stagger-children",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 fade-in-blur",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:o==="session"&&v==="session_entry"?`Add to Session: ${r==null?void 0:r.title}`:"Attendee Information"}),e.jsx("button",{onClick:()=>{u(!1),d(null),p(!1),j(!1)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(C,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 fade-in-blur",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsxs("p",{className:"text-gray-900",children:[c.first_name," ",c.last_name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Personal ID"}),e.jsx("p",{className:"text-gray-900",children:c.personal_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:c.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${c.current_status==="inside"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:c.current_status==="inside"?"Inside":"Outside"})]})]}),o==="session"&&v==="session_entry"&&e.jsx("div",{className:"fade-in-blur",children:re?e.jsxs("div",{className:"flex items-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),e.jsx("span",{className:"text-blue-800 text-sm",children:"Checking session status..."})]}):X?e.jsxs("div",{className:"flex items-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx(J,{className:"h-5 w-5 text-yellow-500 mr-2"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-yellow-800 font-medium block",children:"Already attended this session"}),e.jsx("span",{className:"text-yellow-700 text-sm block mt-1",children:"This attendee has already been added to the session"})]})]}):V?e.jsxs("div",{className:"flex items-center p-3 bg-green-50 rounded-lg",children:[e.jsx(J,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-800 font-medium",children:"Ready to add to session"})]}):e.jsxs("div",{className:"flex items-center p-3 bg-red-50 rounded-lg",children:[e.jsx(he,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-red-800 font-medium block",children:"Attendee hasn't booked this session"}),e.jsx("span",{className:"text-red-700 text-sm block mt-1",children:"Please book the session first or head to info desk"})]})]})}),e.jsx("div",{className:"pt-4 fade-in-blur",children:o==="session"&&v==="session_entry"?e.jsx("button",{onClick:()=>Ee(),disabled:S||!V||X||!!re,className:"w-full bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:S?"Adding to Session...":X?"Already Attended":V?"Add to Session":"Cannot Add - No Booking"}):e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>oe("enter"),disabled:S||c.current_status==="inside",className:"bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:S?"Processing...":"Enter Building"}),e.jsx("button",{onClick:()=>oe("exit"),disabled:S||c.current_status==="outside",className:"bg-red-500 text-white py-3 px-4 rounded-lg hover:bg-red-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:S?"Processing...":"Exit Building"})]})})]})]})})}),document.body)]})]})};export{We as BuildTeamDashboard};
