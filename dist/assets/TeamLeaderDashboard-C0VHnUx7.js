import{o as Be,u as De,r as a,j as e,C as Ie,A as Pe,U as Ue,w as Le,s as d}from"./index-Cj-T6Nn4.js";import{D as $e,X as j,Q as ze,M as Ve,B as Fe}from"./DashboardLayout-C3lQ1M3v.js";import{S as de,Q as Ee}from"./QRScanner-C8WO87w4.js";import{P as Qe}from"./plus-DLUIUrBD.js";import"./heart-D5GG3oA0.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=Be("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),Ke=()=>{const{profile:i}=De(),[y,v]=a.useState(!1),[ue,$]=a.useState(!1),[z,X]=a.useState("scan"),[Y,M]=a.useState(!1),[me,V]=a.useState(""),[J,B]=a.useState([]),[K,D]=a.useState(!1),[x,A]=a.useState(null),[xe,I]=a.useState(!1),[qe,P]=a.useState(!1),[he,W]=a.useState(!1),[ge,Z]=a.useState("attendance"),[fe,U]=a.useState(!1),[F,ee]=a.useState(""),[E,se]=a.useState(""),[N,te]=a.useState(""),[h,Q]=a.useState([]),[pe,O]=a.useState(""),[ae,g]=a.useState([]),[be,ne]=a.useState(!1),[je,R]=a.useState(!1),[w,_]=a.useState(5),[ye,f]=a.useState(""),[le,q]=a.useState([]),[u,p]=a.useState(null),[re,S]=a.useState(!1),[c,ve]=a.useState({inside_building:0,inside_event:0,total_attendees:0}),[L,G]=a.useState(null),r=(s,t)=>{G({type:s,message:t}),setTimeout(()=>G(null),5e3)},b=()=>i==null?void 0:i.tl_team,ie=async()=>{try{const{data:s,error:t}=await Le();!t&&s&&ve({inside_building:s.inside_building,inside_event:s.inside_event,total_attendees:s.total_attendees})}catch(s){console.error("Error fetching building stats:",s)}};a.useEffect(()=>{ie();const s=setInterval(ie,3e4);return()=>clearInterval(s)},[]);const Ne=async s=>{try{console.log("Processing QR data:",s);let t=null;if(s.includes("-")){const{data:l,error:o}=await d.from("users_profiles").select("*").eq("id",s.trim()).single();!o&&l&&(t=l)}else{const{data:l,error:o}=await d.from("users_profiles").select("*").eq("volunteer_id",s.trim()).single();!o&&l&&(t=l)}if(!t){r("error","Volunteer not found");return}const n=b();if(t.role!==n){r("error","Volunteer not in your team");return}if(M(!1),ge==="bonus")p(t),k(!0);else{const l=new Date;l.setHours(0,0,0,0);const{data:o,error:m}=await d.from("attendances").select("*").eq("user_id",t.id).eq("scan_type","vol_attendance").gte("scanned_at",l.toISOString()).limit(1);!m&&o&&o.length>0?W(!0):W(!1),A(t),P(!0),I(!0)}}catch(t){console.error("QR scan error:",t),r("error","Failed to process QR code")}},we=async s=>{if(!s.trim()){B([]);return}try{const t=b();if(!t){r("error","No team assigned");return}const{data:n,error:l}=await d.from("users_profiles").select("*").or(`personal_id.ilike.%${s}%,volunteer_id.ilike.%${s}%`).eq("role",t).limit(10);!l&&n&&(B(n),D(!0))}catch(t){console.error("Search error:",t),B([])}},_e=async()=>{if(x)try{v(!0);const{error:s}=await d.from("attendances").insert([{user_id:x.id,scan_type:"vol_attendance",scanned_by:i==null?void 0:i.id}]);if(s){r("error","Failed to record attendance");return}r("success","Attendance recorded successfully!"),I(!1),A(null),P(!1),$(!1)}catch(s){console.error("Attendance action error:",s),r("error","Failed to record attendance")}finally{v(!1)}},Se=async s=>{if(!s||s.trim().length<2){g([]);return}ne(!0);try{const t=b();if(!t){g([]);return}const{data:n,error:l}=await d.from("users_profiles").select("id, first_name, last_name, personal_id, role, email, volunteer_id, tl_team").or(`personal_id.ilike.%${s.trim()}%,volunteer_id.ilike.%${s.trim()}%`).eq("role",t).order("volunteer_id").limit(10);if(l)console.error("Search error:",l),g([]);else{const o=(n||[]).filter(m=>!h.some(C=>C.id===m.id)&&m.id!==(i==null?void 0:i.id));g(o)}}catch(t){console.error("Search exception:",t),g([])}finally{ne(!1)}},ke=s=>{Q(t=>[...t,s]),g(t=>t.filter(n=>n.id!==s.id)),O("")},Ce=s=>{Q(t=>t.filter(n=>n.id!==s))},T=()=>{Q([]),O(""),g([])},Ae=async()=>{if(!F||!E||!N){r("error","Please fill all required fields!");return}if(console.log("=== DEBUG ANNOUNCEMENT ==="),console.log("announcementRole:",N),console.log("getTeamLeaderTeam():",b()),console.log("selectedUsers count:",h.length),console.log("======================"),N==="custom"&&h.length===0){r("error","Please select at least one user for custom announcements!");return}v(!0);try{let s,t=null,n=null;if(N==="custom")s="specific_users",n=h.map(C=>C.id);else{const C=b();if(!C){r("error","No team assigned");return}s="role",t=C}console.log("Calling send_notification RPC with:",{targetType:s,targetRole:t,targetUserIds:n});const l={title_param:F,message_param:E,target_type_param:s};t&&(l.target_role_param=t),n&&n.length>0&&(l.target_user_ids_param=n);const{data:o,error:m}=await d.rpc("send_notification",l);m?(console.error("Notification RPC error:",m),r("error","Failed to send announcement: "+m.message)):(console.log("SUCCESS - Notification sent with ID:",o),r("success","Announcement sent successfully!"),U(!1),ee(""),se(""),te(""),T())}catch(s){console.error("Send announcement error:",s),r("error","Failed to send announcement")}finally{v(!1)}},Re=async s=>{if(!s.trim()){q([]);return}try{const t=b();if(!t){r("error","No team assigned");return}const{data:n,error:l}=await d.from("users_profiles").select("*").or(`personal_id.ilike.%${s}%,volunteer_id.ilike.%${s}%`).eq("role",t).limit(10);if(!l&&n){const o=n.filter(m=>m.id!==(i==null?void 0:i.id));q(o),S(!0)}}catch(t){console.error("Search error:",t),q([])}},Te=async()=>{if(!u||w<1||w>30){r("error","Please select a user and set bonus amount (1-30)");return}v(!0);try{const{error:s}=await d.from("user_scores").insert([{user_id:u.id,points:w,activity_type:"vol_bonus",activity_description:"Bonus points assigned by team leader"}]);if(s)r("error","Failed to assign bonus");else{const{data:t}=await d.from("users_profiles").select("score").eq("id",u.id).single();t&&await d.from("users_profiles").update({score:(t.score||0)+w}).eq("id",u.id),r("success",`Bonus of ${w} points assigned successfully!`),R(!1),p(null),f(""),_(5),k(!1)}}catch{r("error","Failed to assign bonus")}finally{v(!1)}},[oe,k]=a.useState(!1),[H,ce]=a.useState("scan"),Me=()=>{const s=b();return s?[{value:s,label:{volunteer:"Volunteers",registration:"Registration Team",building:"Building Team",info_desk:"Info Desk Team",team_leader:"Team Leaders",ushers:"Ushers",marketing:"Marketing Team",media:"Media Team",ER:"ER Team",BD:"BD Team",catering:"Catering Team",feedback:"Feedback Team",stage:"Stage Team"}[s]||s},{value:"custom",label:"Custom Selection"}]:[]};return e.jsx($e,{title:"Team Leader Dashboard",subtitle:"Manage your team, track attendance, and assign bonuses",children:e.jsxs("div",{className:"fade-in-up-blur relative",children:[e.jsxs("div",{className:"space-y-8",children:[L&&e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center space-x-2 px-4 py-3 rounded-lg shadow-lg fade-in-blur ${L.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:[L.type==="success"?e.jsx(Ie,{className:"h-5 w-5"}):e.jsx(Pe,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:L.message}),e.jsx("button",{onClick:()=>G(null),className:"ml-2 hover:bg-black hover:bg-opacity-20 rounded p-1 transition-colors",children:e.jsx(j,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 fade-in-blur card-hover dashboard-card",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2 mb-8",children:[e.jsx(Ue,{className:"h-8 w-8 text-orange-500"}),"Manage Your Team"]})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-center stagger-children",children:[e.jsxs("button",{onClick:()=>$(!0),className:"flex-1 flex flex-col items-center justify-center py-6 px-4 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-all duration-300 smooth-hover",children:[e.jsx(ze,{className:"h-8 w-8 mb-2"}),e.jsx("span",{className:"text-base font-medium",children:"Mark Attendance"})]}),e.jsxs("button",{onClick:()=>R(!0),className:"flex-1 flex flex-col items-center justify-center py-6 px-4 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-all duration-300 smooth-hover",children:[e.jsx(Oe,{className:"h-8 w-8 mb-2"}),e.jsx("span",{className:"text-base font-medium",children:"Assign Bonus"})]}),e.jsxs("button",{onClick:()=>U(!0),className:"flex-1 flex flex-col items-center justify-center py-6 px-4 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-all duration-300 smooth-hover",children:[e.jsx(Ve,{className:"h-8 w-8 mb-2"}),e.jsx("span",{className:"text-base font-medium",children:"Send Announcement"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden fade-in-blur card-hover dashboard-card",children:[e.jsx("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gray-50",children:e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2 mx-auto",children:[e.jsx(Fe,{className:"h-7 w-7 text-orange-500"}),"Flow Dashboard"]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 px-6 py-6 text-center stagger-children",children:[e.jsxs("div",{className:"bg-green-100 p-4 rounded-lg shadow-sm card-hover smooth-hover",children:[e.jsx("p",{className:"text-2xl font-bold text-green-900",children:c.inside_building}),e.jsx("p",{className:"text-lg font-bold text-gray-700",children:"Inside Building"})]}),e.jsxs("div",{className:"bg-teal-100 p-4 rounded-lg shadow-sm card-hover smooth-hover",children:[e.jsx("p",{className:"text-2xl font-bold text-teal-900",children:c.inside_event}),e.jsx("p",{className:"text-lg font-bold text-gray-700",children:"Inside Event"})]}),e.jsxs("div",{className:"bg-blue-100 p-4 rounded-lg shadow-sm card-hover smooth-hover",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:c.total_attendees}),e.jsx("p",{className:"text-lg font-bold text-gray-700",children:"Total Attendees"})]})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-lg font-bold text-left border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-800 text-xl font-extrabold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Site"}),e.jsx("th",{className:"px-4 py-3",children:"Maximum Capacity"}),e.jsx("th",{className:"px-4 py-3",children:"Current Capacity"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3",children:"Building"}),e.jsx("td",{className:"px-4 py-3 text-red-600",children:"500"}),e.jsxs("td",{className:"px-4 py-3",children:[c.inside_building>0?Math.round(c.inside_building/500*100):0,"%"]})]}),e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3",children:"Event"}),e.jsx("td",{className:"px-4 py-3 text-red-600",children:"4000"}),e.jsxs("td",{className:"px-4 py-3",children:[c.inside_event>0?Math.round(c.inside_event/4e3*100):0,"%"]})]}),e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3",children:"Total"}),e.jsx("td",{className:"px-4 py-3 text-red-600",children:"4500"}),e.jsxs("td",{className:"px-4 py-3",children:[c.inside_building+c.inside_event>0?Math.round((c.inside_building+c.inside_event)/4500*100):0,"%"]})]})]})]})})})]})]}),ue&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-[100]",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md relative",children:[e.jsx("button",{onClick:()=>{$(!1),A(null),P(!1),V(""),B([])},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(j,{className:"h-6 w-6"})}),e.jsx("h2",{className:"text-lg font-semibold text-black mb-4 text-center",children:"Mark Attendance"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>X("scan"),className:`flex-1 py-2 px-4 rounded-lg transition-all duration-300 ${z==="scan"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,children:"QR Scanner"}),e.jsx("button",{onClick:()=>X("search"),className:`flex-1 py-2 px-4 rounded-lg transition-all duration-300 ${z==="search"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,children:"Search"})]}),z==="scan"?e.jsx("div",{className:"space-y-4",children:e.jsx("button",{onClick:()=>{Z("attendance"),M(!0)},className:"w-full bg-blue-500 text-white py-3 px-4 rounded-lg hover:bg-blue-600 transition-all duration-300 font-medium",children:"Open QR Scanner"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:me,onChange:s=>{V(s.target.value),we(s.target.value)},onFocus:()=>D(!0),placeholder:"Search by Personal ID or Volunteer ID",className:"w-full border rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300"}),e.jsx(de,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),K&&J.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-40 max-h-60 overflow-y-auto",children:J.map(s=>e.jsx("button",{onClick:()=>{A(s),V(`${s.first_name} ${s.last_name} (${s.volunteer_id})`),D(!1),I(!0)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 transition-all duration-300",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",s.volunteer_id," | Personal ID: ",s.personal_id]}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:s.role.replace("_"," ")})]})},s.id))})]}),K&&e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>D(!1)})]})]})}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-[100]",children:e.jsx(Ee,{isOpen:Y,onClose:()=>M(!1),onScan:Ne,title:"Scan Volunteer QR Code",description:"Point your camera at the volunteer's QR code"})}),xe&&x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-[100]",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Volunteer Information"}),e.jsx("button",{onClick:()=>{I(!1),A(null),P(!1)},className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(j,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Name:"}),e.jsxs("span",{children:[x.first_name," ",x.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Volunteer ID:"}),e.jsx("span",{children:x.volunteer_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Email:"}),e.jsx("span",{children:x.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Personal ID:"}),e.jsx("span",{children:x.personal_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Role:"}),e.jsx("span",{className:"capitalize",children:x.role.replace("_"," ")})]})]}),e.jsx("div",{className:"mt-6",children:he?e.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded-lg",children:e.jsx("p",{className:"font-medium",children:"This volunteer has already attended today."})}):e.jsx("button",{onClick:_e,disabled:y,className:"w-full bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 disabled:opacity-50 transition-all duration-300 font-medium",children:y?"Recording...":"Mark Attendance"})})]})}),fe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-[100]",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto relative",children:[e.jsx("button",{onClick:()=>{U(!1),T()},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(j,{className:"h-6 w-6"})}),e.jsx("h2",{className:"text-lg font-semibold text-black mb-4 text-center",children:"Send Announcement"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:F,onChange:s=>ee(s.target.value),placeholder:"Message Title",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300"}),e.jsx("textarea",{value:E,onChange:s=>se(s.target.value),placeholder:"Message Description",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300",rows:3}),e.jsxs("select",{value:N,onChange:s=>{te(s.target.value),s.target.value!=="custom"&&T()},className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300",children:[e.jsx("option",{value:"",children:"Select Target"}),Me().map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),N==="custom"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:pe,onChange:s=>{O(s.target.value),Se(s.target.value)},placeholder:"Search by Personal ID or Volunteer ID...",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300"}),be&&e.jsx("div",{className:"absolute right-3 top-3",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),ae.length>0&&e.jsx("div",{className:"max-h-40 overflow-y-auto border rounded-lg",children:ae.map(s=>e.jsx("div",{onClick:()=>ke(s),className:"p-3 hover:bg-gray-50 cursor-pointer border-b last:border-b-0 transition-all duration-300",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Vol ID: ",s.volunteer_id," | Personal ID: ",s.personal_id]})]}),e.jsx(Qe,{className:"h-4 w-4 text-blue-500"})]})},s.id))}),h.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Selected Users (",h.length,")"]}),e.jsx("button",{onClick:T,className:"text-xs text-red-500 hover:text-red-700 transition-colors",children:"Clear All"})]}),e.jsx("div",{className:"max-h-32 overflow-y-auto border rounded-lg bg-gray-50",children:h.map(s=>e.jsxs("div",{className:"p-2 flex justify-between items-center border-b last:border-b-0",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",s.personal_id]})]}),e.jsx("button",{onClick:()=>Ce(s.id),className:"text-red-500 hover:text-red-700 transition-colors",children:e.jsx(j,{className:"h-4 w-4"})})]},s.id))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{U(!1),T()},className:"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 transition-all duration-300",children:"Cancel"}),e.jsx("button",{onClick:Ae,disabled:y,className:"px-4 py-2 rounded-lg bg-purple-500 text-white hover:bg-purple-600 disabled:opacity-50 transition-all duration-300",children:y?"Sending...":"Send"})]})]})}),je&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-[100]",onClick:()=>{oe||(R(!1),p(null),f(""),S(!1),_(5))},children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md relative",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:()=>{R(!1),p(null),f(""),S(!1),_(5),k(!1)},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 z-30 transition-colors",children:e.jsx(j,{className:"h-6 w-6"})}),e.jsx("h2",{className:"text-lg font-semibold text-black mb-4 text-center",children:"Assign Bonus Points"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>ce("scan"),className:`flex-1 py-2 px-4 rounded-lg transition-all duration-300 ${H==="scan"?"bg-green-500 text-white":"bg-gray-200 text-gray-700"}`,children:"QR Scanner"}),e.jsx("button",{onClick:()=>ce("search"),className:`flex-1 py-2 px-4 rounded-lg transition-all duration-300 ${H==="search"?"bg-green-500 text-white":"bg-gray-200 text-gray-700"}`,children:"Search"})]}),H==="scan"?e.jsx("div",{className:"space-y-4",children:e.jsx("button",{onClick:()=>{Z("bonus"),M(!0),R(!1)},className:"w-full bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 transition-all duration-300 font-medium",children:"Open QR Scanner"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:ye,onChange:s=>{f(s.target.value),Re(s.target.value)},onFocus:()=>S(!0),placeholder:"Search by Personal ID or Volunteer ID",className:"w-full border rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-300"}),e.jsx(de,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),re&&le.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-40 max-h-60 overflow-y-auto",children:le.map(s=>e.jsx("button",{onClick:()=>{p(s),f(`${s.first_name} ${s.last_name} (${s.volunteer_id})`),S(!1),k(!0)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 transition-all duration-300",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",s.volunteer_id," | Personal ID: ",s.personal_id]}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:s.role.replace("_"," ")})]})},s.id))})]}),re&&e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>S(!1)})]})]})}),oe&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-[100]",onClick:()=>{k(!1),p(null),f(""),_(5)},children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Assign Bonus"}),e.jsx("button",{onClick:()=>{k(!1),p(null),f(""),_(5)},className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(j,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Name:"}),e.jsxs("span",{children:[u.first_name," ",u.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Volunteer ID:"}),e.jsx("span",{children:u.volunteer_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Personal ID:"}),e.jsx("span",{children:u.personal_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Role:"}),e.jsx("span",{className:"capitalize",children:u.role.replace("_"," ")})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bonus Points (1-30)"}),e.jsx("input",{type:"number",min:"1",max:"30",value:w,onChange:s=>_(Math.min(30,Math.max(1,parseInt(s.target.value)||1))),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-300"})]}),e.jsx("button",{onClick:Te,disabled:y,className:"w-full bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 disabled:opacity-50 transition-all duration-300 font-medium",children:y?"Assigning...":"Give Bonus"})]})})]})})};export{Ke as TeamLeaderDashboard};
